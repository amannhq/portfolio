---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { SITE } from '../../consts';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  });
}
---

<Layout
  title={`Blog â€” ${SITE.author}`}
  description="Thoughts on software development, tools, and building things"
>
  <section class="py-8">
    <header class="mb-12">
      <p class="section-label mb-2">Writing</p>
      <h1 class="mb-3 text-[2rem] tracking-tight">Blog</h1>
      <p class="m-0 max-w-md text-[--color-text-secondary]">
        Thoughts on software development, developer tools, and lessons learned along the way.
      </p>
    </header>

    <div class="space-y-2">
      {posts.map((post) => (
        <a
          href={`/blog/${post.id}/`}
          class="group -mx-4 flex flex-col gap-3 rounded-xl px-4 py-4 transition-all hover:bg-[--color-bg-secondary] sm:flex-row sm:items-start sm:justify-between sm:gap-8"
        >
          <div class="min-w-0 flex-1">
            <h2 class="m-0 mb-1.5 text-base font-medium text-[--color-text] transition-colors group-hover:text-[--color-accent]">
              {post.data.title}
            </h2>
            <p class="m-0 line-clamp-2 text-[13px] leading-relaxed text-[--color-text-secondary]">
              {post.data.description}
            </p>
          </div>
          <span class="shrink-0 text-[13px] tabular-nums text-[--color-text-tertiary]">
            {formatDate(post.data.pubDate)}
          </span>
        </a>
      ))}
    </div>
  </section>
</Layout>
